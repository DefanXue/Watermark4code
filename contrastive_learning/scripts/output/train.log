2025/09/09 21:44:41 - INFO - __main__ - 配置文件: ../configs/default_config.yaml
2025/09/09 21:44:41 - INFO - __main__ - 输出目录: ./output
2025/09/09 21:44:41 - INFO - __main__ - 训练配置:
2025/09/09 21:44:41 - INFO - __main__ - augmentation:
  strategies:
    change_whitespace: 0.7
    convert_for_while: 0.4
    insert_comments: 0.3
    reformat_code: 0.6
    rename_variables: 0.8
    reorder_statements: 0.5
data:
  max_length: 512
  test_path: contrastive_learning/datasets/csn_java/test_augmented_code.jsonl
  train_path: contrastive_learning/datasets/csn_java/train_augmented_code.jsonl
  val_path: contrastive_learning/datasets/csn_java/valid_augmented_code.jsonl
evaluation:
  batch_size: 128
  num_workers: 4
model:
  lora_alpha: 32
  lora_dropout: 0.1
  lora_r: 16
  name: Salesforce/codet5-base
  pooling_strategy: mean
  projection_dim: 128
  projection_hidden_dim: 512
  target_modules:
  - q
  - k
  - v
  - o
  - wi
  - wo
  use_quantization: true
training:
  batch_size: 64
  eval_steps: 1000
  gradient_accumulation_steps: 1
  learning_rate: 5.0e-05
  logging_steps: 100
  max_grad_norm: 1.0
  num_epochs: 10
  num_workers: 4
  output_dir: ./output
  save_steps: 1000
  seed: 42
  temperature: 0.07
  use_amp: true
  warmup_ratio: 0.1
  weight_decay: 0.01

2025/09/09 21:44:41 - INFO - __main__ - 加载 tokenizer: Salesforce/codet5-base
2025/09/09 21:44:45 - INFO - __main__ - 初始化代码增强器
2025/09/09 21:44:45 - INFO - __main__ - 加载训练数据集: contrastive_learning/datasets/csn_java/train_augmented_code.jsonl
